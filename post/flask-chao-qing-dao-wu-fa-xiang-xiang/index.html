<!DOCTYPE html>
<html>
  <head>
      
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>ä¸€æ­çš„å°é»‘å±‹</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<meta name="description" content="ä½ å¥½  é“ä»”   :D"/>
<meta name="keywords" content="ä½ å¥½  é“ä»”   :D"/>

<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
<link rel="shortcut icon" href="https://yihangliak.github.io/blog//favicon.ico">

<link rel="stylesheet" href="https://yihangliak.github.io/blog//styles/main.css">

<!-- Modernizr JS -->
<script src="https://yihangliak.github.io/blog//media/scripts/_vendors/modernizr-2.6.2.min.js"></script>
<!-- FOR IE9 below -->
<!--[if lt IE 9]>
<scripts src="https://yihangliak.github.io/blog//media/scripts/_vendors/respond.min.js"></scripts>
<![endif]-->

<!-- Comment -->


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/tomorrow-night.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
<link crossorigin="anonymous" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" href="https://lib.baomitu.com/font-awesome/5.8.1/css/all.min.css" rel="stylesheet">

  </head>
  <body>
  
<div id="fh5co-offcanvas">
    <a href="#!" class="fh5co-close-offcanvas js-fh5co-close-offcanvas">
        <span><i class="icon-cross3"></i> <span>Close</span></span>
    </a>
    <div class="fh5co-bio">
        <figure>
            <img src="https://yihangliak.github.io/blog//media/images/avatar.png" alt="ä¸€æ­çš„å°é»‘å±‹" class="img-responsive">
        </figure>
        <h3 class="heading">ABOUT ME</h3>
        <h2>ä¸€æ­çš„å°é»‘å±‹</h2>
        <p>ä½ å¥½  é“ä»”   :D</p>
        <ul class="fh5co-social">
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
        </ul>
    </div>

    <div class="fh5co-menu">
        <div class="fh5co-box">
            <h3 class="heading">æœç´¢</h3>
            <form action="#">
                <div class="form-group">
                    <input type="text" class="form-control" placeholder="è¾“å…¥å…³é”®å­—">
                </div>
            </form>
        </div>
        <div class="fh5co-box">
            <h3 class="heading">æ ‡ç­¾</h3>
            <ul>
                
                    <li><a href="https://yihangliak.github.io/blog//tag/RIfr7ujrR">Selenium</a></li>
                
                    <li><a href="https://yihangliak.github.io/blog//tag/kFYrwlZ3T">Python</a></li>
                
                    <li><a href="https://yihangliak.github.io/blog//tag/1bMilhU6w">SVN</a></li>
                
            </ul>
        </div>
    </div>
</div>

<header id="fh5co-header">
    <div class="container-fluid">
        <div class="row">
            <a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>
            <ul class="fh5co-social">
                
                    <li>
                        <a href="https://yihangliak.github.io/blog/"
                         >
                            é¦–é¡µ
                        </a>
                    </li>
                
                    <li>
                        <a href="https://yihangliak.github.io/blog//archives"
                         >
                            å½’æ¡£
                        </a>
                    </li>
                
                    <li>
                        <a href="https://yihangliak.github.io/blog//tags"
                         >
                            æ ‡ç­¾
                        </a>
                    </li>
                
                    <li>
                        <a href="https://yihangliak.github.io/blog//post/guan-yu-wo/"
                         >
                            å…³äº
                        </a>
                    </li>
                
            </ul>
            <div class="col-lg-12 col-md-12 text-center">
                <h1 id="fh5co-logo">
                    <a href="https://yihangliak.github.io/blog/">ä¸€æ­çš„å°é»‘å±‹</a>
                </h1>
            </div>
        </div>
    </div>
</header>


<!--  <a href="#" class="fh5co-post-prev"><span>ğŸ‘ˆ Prev</span></a>-->
<!--  <a href="#" class="fh5co-post-next"><span>Next ğŸ‘‰</span></a>-->

  <div class="container-fluid">
      <div class="row fh5co-post-entry single-entry">
          <article class="col-lg-8 col-lg-offset-2 col-md-8 col-md-offset-2 col-sm-8 col-sm-offset-2 col-xs-12 col-xs-offset-0">
              <figure class="animate-box">
                  
                      <img src="https://yihangliak.github.io/blog//post-images/flask-chao-qing-dao-wu-fa-xiang-xiang.png" alt="Flask ä¹‹è·¯" class="img-responsive">
                  
              </figure>
              <span class="fh5co-meta animate-box">
                  
              </span>
              <h2 class="fh5co-article-title animate-box">Flask ä¹‹è·¯</h2>
              <span class="fh5co-meta fh5co-date animate-box">2019-06-21</span>

              <div class="col-lg-12 col-lg-offset-0 col-md-12 col-md-offset-0 col-sm-12 col-sm-offset-0 col-xs-12 col-xs-offset-0 text-left content-article">
                  <div class="row">
                      <div class="col-md-12 animate-box post-content">
                          <p> <h1 id="flaskç®€ä»‹">Flaskç®€ä»‹</h1>
<blockquote>
<p>Flaskæ˜¯ä¸€ä¸ªä½¿ç”¨<code>Python</code>ç¼–å†™çš„è½»é‡çº§webåº”ç”¨æ¡†æ¶
WSGIå·¥å…·ç®±é‡‡ç”¨<code>Werzeug</code>ï¼Œæ¨¡æ¿å¼•æ“ä½¿ç”¨<code>Jinjia2</code></p>
</blockquote>
<h1 id="è¿›å…¥flaskä¸–ç•Œ">è¿›å…¥Flaskä¸–ç•Œ</h1>
<h2 id="1å®‰è£…python">1.å®‰è£…Python</h2>
<p>ç•¥</p>
<h2 id="2å®‰è£…pythonè™šæ‹Ÿç¯å¢ƒ">2.å®‰è£…Pythonè™šæ‹Ÿç¯å¢ƒ</h2>
<p>Pythonè™šæ‹Ÿç¯å¢ƒå¸¸ç”¨å‘½ä»¤</p>
<pre><code>å®‰è£…virtualenv  pip install virtualenv
å®‰è£…è™šæ‹Ÿç¯å¢ƒç®¡ç†å·¥å…·  virtualenvwrapper-winï¼ˆWindowsç³»ç»Ÿï¼‰ 
åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼šmkvirtualenv   xxx
åˆ‡æ¢åˆ°æŸä¸ªè™šæ‹Ÿç¯å¢ƒï¼šworkon xxx
é€€å‡ºå½“å‰è™šæ‹Ÿç¯å¢ƒï¼šdeactivate xxx
åˆ é™¤æŸä¸ªè™šæ‹Ÿç¯å¢ƒï¼šrmvirtualenv  xxx
åˆ—å‡ºæ‰€æœ‰è™šæ‹Ÿç¯å¢ƒï¼šlsvirtualenv
è¿›å…¥è™šæ‹Ÿç¯å¢ƒç›®å½•ï¼šcdvirtualenv
</code></pre>
<p>åœ¨è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…Flask</p>
<pre><code>cmdä¸­ï¼š
1.é¦–å…ˆåˆ‡æ¢åˆ°å·²ç»åˆ›å»ºå¥½çš„è™šæ‹Ÿç¯å¢ƒ
2.è¾“å…¥ï¼špip install flask
</code></pre>
<h1 id="urlä¸è§†å›¾">URLä¸è§†å›¾</h1>
<h2 id="1æœåŠ¡å™¨è§£é‡Š">1.æœåŠ¡å™¨è§£é‡Š</h2>
<p><img src="https://i.loli.net/2019/06/05/5cf698581159673776.png" alt=""></p>
<h2 id="2ç¬¬ä¸€ä¸ªflaskç¨‹åº">2.ç¬¬ä¸€ä¸ªFlaskç¨‹åº</h2>
<p>Flaskçš„ä¼˜åŠ¿ï¼š</p>
<ul>
<li>å¾®å‹æ¡†æ¶ï¼Œç®€æ´ï¼Œæ‰©å±•æ€§å¼º</li>
<li>flaskç›¸å…³ä¾èµ–éå¸¸ä¼˜ç§€ï¼ˆjinja2ï¼‰</li>
<li>å¼€å‘æ•ˆç‡é«˜</li>
<li>ç¤¾ä¼šæ´»è·ƒåº¦é«˜</li>
</ul>
<p>æ–°å»ºä¸€ä¸ªfirst_flask_project.pyæ–‡ä»¶</p>
<pre><code class="language-python">from flask import Flask #å¯¼å…¥Flaskç±»

from demo import config

app = Flask(__name__)  # å®ä¾‹åŒ–Flask

@app.route('/')   # URLæ˜ å°„åˆ°å¯¹åº”è§†å›¾å‡½æ•°
def hello_world():
    return 'Hello World!'


if __name__=='__main__':
    app.run(debug=True, port=81) # æµ‹è¯•ä½¿ç”¨çš„åº”ç”¨æœåŠ¡å™¨


</code></pre>
<p>æ‰§è¡Œè¿™ä¸ªpyæ–‡ä»¶</p>
<p><img src="https://i.loli.net/2019/06/05/5cf69949b9fd033530.png" alt=""></p>
<p>æµè§ˆå™¨è®¿é—®hello_worldè§†å›¾å‡½æ•°å¯¹åº”çš„ç½‘å€</p>
<p><img src="https://i.loli.net/2019/06/05/5cf6998ce1e2a79941.png" alt=""></p>
<h2 id="3dubugæ¨¡å¼">3.DUBUGæ¨¡å¼</h2>
<h3 id="31-ä¸ºä»€ä¹ˆè¦å¼€å¯dubugæ¨¡å¼">3.1 ä¸ºä»€ä¹ˆè¦å¼€å¯DUBUGæ¨¡å¼</h3>
<ul>
<li>ä»£ç æŠ›å‡ºå¼‚å¸¸åï¼Œåœ¨æµè§ˆå™¨ä¸­å¯ä»¥çœ‹åˆ°é”™è¯¯ä¿¡æ¯</li>
<li>æ›´æ–°ä»£ç ä»¥åï¼Œåªè¦ä¿å­˜å°±ä¼šä½¿ä»£ç è‡ªåŠ¨ç”Ÿæ•ˆ</li>
</ul>
<h3 id="32-å¼€å¯debugæ¨¡å¼çš„4ç§æ–¹å¼">3.2 å¼€å¯DEBUGæ¨¡å¼çš„4ç§æ–¹å¼</h3>
<p>ç¬¬ä¸€ç§ï¼šåœ¨app.run()ä¸­ä¼ é€’ä¸€ä¸ªdebug=Trueå‚æ•°</p>
<pre><code class="language-python">if __name__=='__main__':
    app.run(debug=True, port=81)
</code></pre>
<p>ç¬¬äºŒç§ï¼šä½¿ç”¨app.debug=True</p>
<pre><code class="language-python">app = Flask(__name__)  
app.debug = True
</code></pre>
<p>ç¬¬ä¸‰ç§ï¼šä½¿ç”¨updateæ–¹æ³•ï¼Œä»¥å­—å…¸è¿½åŠ çš„å½¢å¼å°†debugå‚æ•°åŠ åˆ°configå­—å…¸ä¸­</p>
<pre><code class="language-python">app = Flask(__name__) 
app.config.update(DEBUG=True)
print(isinstance(app.config, dict))  # ç¡®è®¤configæ˜¯å¦æ˜¯å­—å…¸
</code></pre>
<p>ç¬¬å››ç§ï¼šåŠ è½½é…ç½®æ–‡ä»¶çš„å½¢å¼</p>
<ul>
<li>
<p>åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå†ä»¥æ¨¡å—å½¢å¼å¯¼å…¥</p>
</li>
<li>
<p><img src="https://i.loli.net/2019/06/05/5cf69af23e58681823.png" alt=""></p>
<pre><code class="language-python">from demo import config

app = Flask(__name__)  
app.config.from_object(config)
</code></pre>
</li>
<li>
<p>å¯¼å…¥é…ç½®æ–‡ä»¶çš„å½¢å¼åŠ è½½é…ç½®</p>
<pre><code class="language-python">from flask import Flask 

app = Flask(__name__)  
app.config.from_pyfile('config.py') # è¿™æ ·å¯ä»¥å°‘äº›ä¸€è¡Œå€’æ¨¡å—æ–¹æ³•
# æ³¨æ„è¦å†™æ–‡ä»¶å…¨åï¼ˆåŒ…å«æ–‡ä»¶è·¯å¾„ï¼‰
# ä¸ä»…ä»…æ˜¯pyæ–‡ä»¶ï¼Œå…¶ä»–æ ¼å¼æ–‡ä»¶ä¹Ÿå¯ä»¥
# è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªsilentå‚æ•°ï¼Œè®¾ä¸ºTrueçš„è¯ï¼Œå³ä½¿æ–‡ä»¶ä¸å­˜åœ¨ä¹Ÿä¸ä¼šæŠ¥é”™
</code></pre>
</li>
</ul>
<h2 id="4-urlçš„ä¼ å‚æ–¹å¼">4. URLçš„ä¼ å‚æ–¹å¼</h2>
<p>è§†å›¾å‡½æ•°ä¸Šé¢çš„è£…é¥°å™¨ä¸­URLçš„ä¼ å‚è¯­æ³•ä¸ºï¼š<code>/&lt;å‚æ•°å&gt;</code></p>
<blockquote>
<p>è§†å›¾å‡½æ•°ä¸­è¦å®šä¹‰åŒåå‚æ•°</p>
</blockquote>
<p>ä¸¾ä¾‹ï¼Œæ–°å¢ä¸€ä¸ªurl_view.pyæ–‡ä»¶ï¼Œurlä¸ºæ–‡ç« è¯¦æƒ…é¡µé¢</p>
<pre><code class="language-python">from flask import Flask

app = Flask(__name__)

@app.route('/')
def hello_world():
    return 'Hello World'

@app.route('/p/&lt;articel_id&gt;')
def article_detail(articel_id):  # åœ¨è§†å›¾å‡½æ•°ä¸­ä¹Ÿè¦å®šä¹‰åŒåå‚æ•°
    return 'æ‚¨è¯·æ±‚çš„æ–‡ç« æ˜¯ï¼š{}'.format(articel_id)

if __name__=='__main__':
    app.run(debug=True, port=81)
</code></pre>
<h2 id="5urlå‚æ•°çš„æ•°æ®ç±»å‹">5.URLå‚æ•°çš„æ•°æ®ç±»å‹</h2>
<p>1.å¦‚æœæ²¡æœ‰æŒ‡å®šå…·ä½“çš„æ•°æ®ç±»å‹,é‚£ä¹ˆå°±æ˜¯ä½¿ç”¨<code>string</code>ç±»å‹</p>
<p>2.<code>int</code>ç±»å‹åªèƒ½ä¼ é€’æ•´æ•°ç±»å‹</p>
<pre><code>@app.route('/article/&lt;int:test&gt;')
</code></pre>
<p>3.<code>float</code>ä¼ é€’æµ®ç‚¹å‹æ•°æ®</p>
<p>4.<code>path</code>æ•°æ®ç±»å‹å’Œ<code>string</code>ç±»å‹éƒ½å¯ä»¥æ¥å—ä»»æ„çš„å­—ç¬¦ä¸²,ä½†æ˜¯pathå¯ä»¥æ¥æ”¶è·¯å¾„,ä¹Ÿå°±æ˜¯è¯´å¯ä»¥åŒ…å«æ–œæ </p>
<pre><code class="language-python">@app.route('/article/&lt;path:test&gt;')
def page_detail(test):
    return 'æ‚¨è¯·æ±‚çš„é¡µé¢æ˜¯:{}'.format(test)
</code></pre>
<p>è¯·æ±‚ä¹‹åçš„é¡µé¢ï¼š</p>
<p><img src="https://i.loli.net/2019/06/06/5cf8cf06db0f727689.png" alt=""></p>
<p>5.uuidï¼šæ¥å—ç¬¦åˆ<code>uuid</code>è§„åˆ™çš„å­—ç¬¦ä¸²ï¼Œå…¨å®‡å®™å”¯ä¸€ï¼Œç¼ºç‚¹å°±æ˜¯å¤ªé•¿äº†ï¼Œä¸€èˆ¬ç”¨æ¥åšè¡¨çš„ä¸»é”®</p>
<p>å…ˆå¯¼åŒ…ç”Ÿæˆä¸€ä¸ªuuid</p>
<pre><code class="language-python">import uuid

print(uuid.uuid4())
</code></pre>
<p>åœ¨URLå¯¹åº”çš„è§†å›¾å‡½æ•°ä¸­éªŒè¯</p>
<pre><code class="language-python">@app.route('/u/&lt;uuid:user_id&gt;')
def user_detail(user_id):
    return 'ç”¨æˆ·çš„uuidä¸ºï¼š%s' %user_id
</code></pre>
<p>æ•ˆæœå›¾</p>
<p><img src="https://i.loli.net/2019/06/06/5cf8d2853c4ba94451.png" alt=""></p>
<p>6.anyï¼šå¤šä¸ªURLæ˜ å°„åˆ°åŒä¸€ä¸ªè§†å›¾å‡½æ•°</p>
<p>ä»£ç </p>
<pre><code class="language-python">@app.route('/&lt;any(user,blog):url_path&gt;/&lt;id&gt;/')
def detail(url_path, id):
    if url_path == 'user':
        return 'ç”¨æˆ·idæ˜¯ï¼š%s' %id
    else:
        return 'åšå®¢è¯¦æƒ…æ˜¯ï¼š%s' %id
</code></pre>
<p>éªŒè¯<img src="https://i.loli.net/2019/06/06/5cf8d4b30d41953293.png" alt=""></p>
<h2 id="6æ¥æ”¶ç”¨æˆ·ä¼ é€’çš„å‚æ•°">6.æ¥æ”¶ç”¨æˆ·ä¼ é€’çš„å‚æ•°</h2>
<p>ç¬¬ä¸€ç§ï¼šä½¿ç”¨pathå½¢å¼ï¼ˆå°†å‚æ•°åµŒå…¥åˆ°è·¯å¾„ä¸­ï¼‰ï¼ˆå°±æ˜¯ä¸Šé¢è¯´çš„ï¼‰</p>
<p>ç¬¬äºŒç§ï¼šä½¿ç”¨æŸ¥è¯¢å­—ç¬¦ä¸²çš„æ–¹å¼ï¼Œå°±æ˜¯é€šè¿‡<code>?key=value</code>å½¢å¼ä¼ é€’</p>
<p>ä»£ç ï¼š</p>
<pre><code class="language-python">@app.route('/d/')
def d():
    wd = request.args.get('wd')  # æ³¨æ„åˆ°å¯¼å…¥request
    return 'é€šè¿‡å­—ç¬¦ä¸²ä¼ é€’çš„å‚æ•°æ˜¯ï¼š%s' %wd
</code></pre>
<p>éªŒè¯</p>
<p><img src="https://i.loli.net/2019/06/06/5cf8dad77772c11673.png" alt=""></p>
<p>å¦‚æœæœ‰å¤šä¸ªé”®å€¼å¯¹åšä¸ºå‚æ•°æ—¶ï¼Œä½¿ç”¨<code>&amp;</code>ç¬¦å·è¿›è¡Œåˆ†å‰²</p>
<p>å®ä¾‹</p>
<pre><code class="language-python">@app.route('/d/')
def d():
    wd = request.args.get('wd')
    ie = request.args.get('ie')  # å¤šä¸ªå‚æ•°å†å†™ä¸€ä¸ªè¯·æ±‚å³å¯
    return 'é€šè¿‡å­—ç¬¦ä¸²ä¼ é€’çš„å‚æ•°æ˜¯ï¼šwd=%s,ie=%s' %(wd,ie)
</code></pre>
<p><img src="https://i.loli.net/2019/06/06/5cf8dbe03246a52713.png" alt=""></p>
<p>==å¦‚æœé¡µé¢æƒ³è¦åšSEOä¼˜åŒ–ï¼Œå°±æ˜¯è¢«æœç´¢å¼•æ“æœç´¢åˆ°ï¼Œé‚£ä¹ˆæ¨èä½¿ç”¨ç¬¬ä¸€ç§ï¼ˆpathï¼‰ä¼ é€’æ–¹å¼ï¼Œå¦‚æœä¸åœ¨ä¹SEOï¼Œåˆ™å¯ä»¥ä½¿ç”¨ç¬¬äºŒç§==</p>
<h2 id="7-url_for">7. url_for</h2>
<p>url_forç¬¬ä¸€ä¸ªå‚æ•°ï¼Œåº”è¯¥æ˜¯è§†å›¾å‡½æ•°çš„åå­—çš„å­—ç¬¦ä¸²ï¼Œåé¢çš„å‚æ•°ä¼ é€’ç»™url</p>
<h2 id="8è‡ªå®šä¹‰urlè½¬æ¢å™¨">8.è‡ªå®šä¹‰URLè½¬æ¢å™¨</h2>
<p>1.å®šä¹‰ä¸€ä¸ªç±»ï¼Œé›†æˆ<code>BaseConverter</code></p>
<p>2.åœ¨è¿™ä¸ªç±»ä¸­ï¼Œé‡å†™<code>regex</code>ï¼Œä¹Ÿå°±æ˜¯æ­£åˆ™è¡¨è¾¾å¼</p>
<p>3.å°†è‡ªå®šä¹‰å¥½çš„ç±»ï¼Œæ˜ å°„åˆ°<code>app.url_map.converters</code>ä¸Š</p>
<pre><code class="language-python">from flask import Flask
from werkzeug.routing import BaseConverter

app = Flask(__name__)

# å®šä¹‰è‡ªå·±çš„å‚æ•°è½¬æ¢å™¨ï¼ŒåŒ¹é…æ‰‹æœºå·
class TelephoneConverter(BaseConverter):
    regex = r'1[85734]\d{9}'

app.url_map.converters['tel'] = TelephoneConverter # å°†è‡ªå®šè½¬æ¢å™¨æ·»åŠ åˆ°url_mapä¸­ï¼ˆå­—å…¸æ–¹å¼æ·»åŠ ï¼‰

@app.route('/')
def hello():
    return 'hello world'

@app.route('/user/&lt;int:user_id&gt;/')   # è‡ªå¸¦urlè½¬æ¢å™¨
def user_profile(user_id):
    return 'æ‚¨è¾“å…¥çš„user_idä¸º%s' %user_id

@app.route('/telephone/&lt;tel:user_phone&gt;/')   # ä½¿ç”¨è‡ªå®šä¹‰urlè½¬æ¢å™¨
def user_phone(user_phone):
    return 'æ‚¨çš„æ‰‹æœºå·ä¸ºï¼š%s' %user_phone

if __name__=='__main__':
    app.run(debug=True, port=81)
</code></pre>
<p>to_pythonçš„ä½œç”¨ï¼šè¿™ä¸ªæ–¹æ³•çš„è¿”å›å€¼ï¼Œå°†ä¼šä¼ é€’åˆ°viewå‡½æ•°ä¸­ä½œä¸ºå‚æ•°</p>
<pre><code class="language-python">class ListConverter(BaseConverter):
    def to_python(self, value):
        return value.split('+')
app.url_map.converters['list'] = ListConverter

@app.route('/post/&lt;list:borads&gt;/')
def posts(borads):
    return 'æ‚¨æäº¤çš„ç‰ˆå—æ˜¯ï¼š%s' %borads
</code></pre>
<p>to_urlçš„ä½œç”¨ï¼šè¿™ä¸ªæ–¹æ³•çš„è¿”å›å€¼ï¼Œå°†ä¼šè°ƒç”¨url_forå‡½æ•°çš„æ—¶å€™ç”Ÿæˆç¬¦åˆè¦æ±‚çš„urlå½¢å¼</p>
<h2 id="9å…¶ä»–ç»†èŠ‚çŸ¥è¯†ç‚¹">9.å…¶ä»–ç»†èŠ‚çŸ¥è¯†ç‚¹</h2>
<h3 id="91-å…¶ä»–ç”µè„‘è®¿é—®">9.1 å…¶ä»–ç”µè„‘è®¿é—®</h3>
<p>å¦‚æœæƒ³åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘ä¸‹è®©å…¶ä»–ç”µè„‘è®¿é—®æœ¬æœºä¸Šçš„flaskç½‘ç«™</p>
<p>è¦è®¾ç½®<code>host=0.0.0.0</code>æ‰èƒ½è®¿é—®å¾—åˆ°</p>
<h3 id="92-æŒ‡å®šç«¯å£">9.2 æŒ‡å®šç«¯å£</h3>
<p>è®¾ç½®<code>port=ç«¯å£å·</code></p>
<h3 id="93-urlå”¯ä¸€">9.3 URLå”¯ä¸€</h3>
<p>åœ¨å®šä¹‰URLæ—¶ï¼Œä¸€å®šè¦è®°å¾—åœ¨æœ€ååŠ ä¸€ä¸ªæ–œæ </p>
<ul>
<li>å¦‚æœä¸åŠ æ–œæ ï¼Œé‚£ä¹ˆåœ¨æµè§ˆå™¨ä¸­è®¿é—®è¿™ä¸ªurlæ—¶ï¼Œå¦‚æœåŠ äº†æ–œæ å°±ä¼šè®¿é—®ä¸åˆ°ï¼Œè¿™æ ·ç”¨æˆ·ä½“éªŒä¸å¥½</li>
<li>æœç´¢å¼•æ“ä¼šå°†åŠ ä¸ä¸åŠ çš„è§†ä¸ºä¸¤ä¸ªä¸åŒçš„URLï¼Œå…¶å®ä¸¤ä¸ªéƒ½æ˜¯åŒä¸€ä¸ªURLï¼Œä¼šç»™æœç´¢å¼•æ“é€ æˆè¯¯è§£</li>
</ul>
<p>ä»£ç é‡Œé¢åŠ äº†æ–œæ ä»¥åï¼Œè®¿é—®æ—¶ åŠ ä¸ä¸åŠ  éƒ½å¯ä»¥è®¿é—®</p>
<h3 id="94-è¯·æ±‚æ–¹å¼">9.4 è¯·æ±‚æ–¹å¼</h3>
<p>flaskä¸­çš„routeæ–¹æ³•ï¼Œé»˜è®¤ä½¿ç”¨getè¯·æ±‚</p>
<p>å¦‚æœæƒ³è¦è‡ªå®šä¹‰è¯·æ±‚æ–¹å¼ï¼Œé‚£ä¹ˆåº”è¯¥ä¼ é€’ä¸€ä¸ª<code>method</code>å‚æ•°</p>
<pre><code class="language-python">@app.route('/list/', methods=['GET', 'POST'])
def list():
    return 'hi'
</code></pre>
<h2 id="10é¡µé¢è·³è½¬å’Œé‡å®šå‘">10.é¡µé¢è·³è½¬å’Œé‡å®šå‘</h2>
<p>é‡å®šå‘åˆ†ä¸ºæ°¸ä¹…æ€§é‡å®šå‘å’Œæš‚æ—¶æ€§é‡å®šå‘ï¼Œåœ¨é¡µé¢ä¸Šä½“ç°çš„æ“ä½œå°±æ˜¯æµè§ˆå™¨ä¼šä»ä¸€ä¸ªé¡µé¢è‡ªåŠ¨è·³è½¬åˆ°å¦å¤–ä¸€ä¸ªé¡µé¢</p>
<p>æ¯”å¦‚ç”¨æˆ·è®¿é—®äº†ä¸€ä¸ªéœ€è¦æƒé™çš„é¡µé¢ï¼Œä½†æ˜¯è¯¥ç”¨æˆ·å½“å‰å¹¶æ²¡æœ‰ç™»å½•ï¼Œå› æ­¤æˆ‘ä»¬åº”è¯¥ç»™ä»–é‡å®šå‘åˆ°ç™»å½•é¡µé¢</p>
<ul>
<li>æ°¸ä¹…æ€§é‡å®šå‘ï¼š<code>http</code>çš„çŠ¶æ€ç æ˜¯<code>301</code>ï¼Œå¤šç”¨äºæ—§ç½‘å€è¢«åºŸå¼ƒäº†è¦è½¬åˆ°ä¸€ä¸ªæ–°çš„ç½‘å€ç¡®ä¿ç”¨æˆ·çš„è®¿é—®</li>
<li>æš‚æ—¶æ€§é‡å®šå‘ï¼Œ<code>http</code>çš„çŠ¶æ€ç æ˜¯<code>302</code>ï¼Œè¡¨ç¤ºé¡µé¢çš„æš‚æ—¶æ€§è·³è½¬ã€‚æ¯”å¦‚ä¸€ä¸ªéœ€è¦æƒé™çš„ç½‘å€ï¼Œå¦‚æœå½“å‰ç”¨æˆ·æ²¡æœ‰ç™»å½•ï¼Œåº”è¯¥é‡å®šå‘ç™»å½•é¡µé¢ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œåº”è¯¥æš‚æ—¶æ€§é‡å®šå‘</li>
</ul>
<p>åœ¨flaskä¸­ï¼Œé‡å®šå‘æ˜¯é€šè¿‡<code>flask.redirect(location, code=302)</code>è¿™ä¸ªå‡½æ•°æ¥å®ç°çš„ï¼Œ<code>location</code>è¡¨ç¤ºéœ€è¦é‡å®šå‘åˆ°çš„URLï¼Œåº”è¯¥é…åˆä¹‹å‰çš„<code>url_for</code>å‡½æ•°æ¥ä½¿ç”¨ï¼Œ<code>code</code>è¡¨ç¤ºé‡‡ç”¨å“ªä¸ªé‡å®šå‘ï¼Œé»˜è®¤æ˜¯<code>302</code>ï¼Œå³<code>æš‚æ—¶æ€§é‡å®šå‘</code>ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹æˆ<code>301</code>æ¥å®ç°æ°¸ä¹…æ€§é‡å®šå‘</p>
<p>ä»£ç æ¡ˆä¾‹ï¼š</p>
<pre><code class="language-python">from flask import Flask, request, url_for
from werkzeug.utils import redirect

app = Flask(__name__)

@app.route('/')
def hello():
    return 'hello world'

@app.route('/login/')
def login():
    return 'è¿™æ˜¯ç™»å½•é¡µé¢'

@app.route('/profile/')   # ä¸ªäººä¸­å¿ƒè§†å›¾å‡½æ•°
def profile():
    if request.args.get('name'):  # ä½¿ç”¨requestæ£€æŸ¥urlä¸­æ˜¯å¦æœ‰nameå‚æ•°
        return 'ä¸ªäººä¸­å¿ƒé¡µé¢'
    else:
        return redirect(url_for('login'))  # ä½¿ç”¨redirect+url_foré‡å®šå‘urlï¼Œæ³¨æ„ï¼Œå¯ä»¥å®šä¹‰codeå‚æ•°ï¼Œé»˜è®¤302å³æš‚æ—¶æ€§é‡å®šå‘

if __name__=='__main__':
    app.run(debug=True, port=81)
</code></pre>
<p>è®¿é—®profileåœ¨æ²¡æœ‰åŠ nameå‚æ•°çš„æƒ…å†µä¸‹ä¼šè‡ªåŠ¨æš‚æ—¶æ€§é‡å®šå‘åˆ°ç™»å½•é¡µé¢</p>
<p><img src="https://i.loli.net/2019/06/11/5cff5e9c07a6469200.gif" alt=""></p>
<p>è®¿é—®profileåŠ äº†nameå‚æ•°ä»¥åï¼Œæ­£å¸¸è®¿é—®åˆ°ä¸ªäººä¸­å¿ƒé¡µé¢</p>
<p><img src="https://i.loli.net/2019/06/11/5cff5f0d7c57687406.png" alt=""></p>
<h2 id="11å…³äºå“åº”response">11.å…³äºå“åº”ï¼ˆResponseï¼‰</h2>
<p>è§†å›¾å‡½æ•°çš„è¿”å›å€¼ä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸ºä¸€ä¸ªå“åº”å¯¹è±¡ï¼Œflaskçš„è½¬æ¢é€»è¾‘å¦‚ä¸‹ï¼š</p>
<ul>
<li>å¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ªåˆæ³•çš„å“åº”å¯¹è±¡ï¼Œåˆ™ç›´æ¥è¿”å›</li>
<li>å¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆflaskä¼šé‡æ–°åˆ›å»ºä¸€ä¸ª<code>werkzeug.wrappers.Response</code>å¯¹è±¡ï¼Œ<code>Response</code>å¯¹è±¡å°†è¯¥å­—ç¬¦ä¸²ä½œä¸ºä¸»ä½“ï¼ŒçŠ¶æ€ç ä¸º<code>200</code>ï¼Œ<code>MIME</code>ç±»å‹ä¸º<code>text/html</code>ï¼Œç„¶åè¿”å›è¯¥<code>Response</code>å¯¹è±¡</li>
<li>å¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ªå…ƒç¥–ï¼Œå…ƒç¥–ä¸­çš„æ•°æ®ç±»å‹æ˜¯ï¼ˆresponse,status,headersï¼‰ã€‚statuså€¼ä¼šè¦†ç›–é»˜è®¤çš„200çŠ¶æ€ç ï¼Œheaderså¯ä»¥æ˜¯ä¸€ä¸ªåˆ—è¡¨æˆ–è€…å­—å…¸ï¼Œä½œä¸ºé¢å¤–çš„æ¶ˆæ¯å¤´</li>
<li>å¦‚æœä»¥ä¸Šæ¡ä»¶éƒ½ä¸æ»¡è¶³ï¼Œflaskä¼šå‡è®¾è¿”å›å€¼æ˜¯ä¸€ä¸ªåˆæ³•çš„<code>WSGI</code>åº”ç”¨ç¨‹åºï¼Œå¹¶é€šè¿‡<code>Response.force_type(rv,request,environ)</code>è½¬æ¢ä¸ºä¸€ä¸ªè¯·æ±‚å¯¹è±¡</li>
</ul>
<blockquote>
<p>ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œç›´æ¥ä½¿ç”¨<code>Response</code>åˆ›å»ºï¼š</p>
</blockquote>
<pre><code class="language-python">from flask import Flask, Response

@app.route('/about/')
def about():
    resp = Response(response='about page', status=200, content_type='text/html;charset=utf-8')
    return resp
</code></pre>
<blockquote>
<p>ç¬¬äºŒä¸ªä¾‹å­ï¼Œä½¿ç”¨<code>å­—ç¬¦ä¸²</code>åˆ›å»ºï¼š</p>
</blockquote>
<pre><code class="language-python">@app.route('/')
def hello():
    return 'hello world' # ç›´æ¥è¿”å›å­—ç¬¦ä¸²ï¼Œflaskä¹Ÿä¼šè‡ªåŠ¨ç»„è£…æˆä¸€ä¸ªResponseå¯¹è±¡è¿”å›
</code></pre>
<blockquote>
<p>ç¬¬ä¸‰ä¸ªä¾‹å­ï¼Œä½¿ç”¨<code>å…ƒç¥–</code>åˆ›å»ºï¼š</p>
</blockquote>
<pre><code class="language-python">@app.route('/about2/')
def about2():
    return 'about2',200,{'X-NAME':'Alex'}
</code></pre>
<p><img src="https://i.loli.net/2019/06/12/5d00680c5542521648.png" alt=""></p>
<blockquote>
<p>ç¬¬å››ä¸ªä¾‹å­ï¼Œ<code>è‡ªå®šä¹‰å“åº”</code>ï¼Œè‡ªå®šä¹‰å“åº”å¿…é¡»æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶ï¼š</p>
</blockquote>
<ul>
<li>å¿…é¡»ç»§æ‰¿è‡ª<code>Respone</code>ç±»</li>
<li>å®ç°ç±»æ–¹æ³•<code>force_type(cls,rv,nviron=None)</code></li>
<li>å¿…é¡»æŒ‡å®š<code>app.respone_class</code>ä¸ºä½ è‡ªå®šä¹‰çš„<code>Respone</code></li>
</ul>
<p><code>Restful API</code>éƒ½æ˜¯é€šè¿‡<code>json</code>çš„å½¢å¼è¿›è¡Œä¼ é€’ï¼Œå¦‚æœä½ çš„åå°è·Ÿå‰å°è¿›è¡Œäº¤äº’ï¼Œæ‰€æœ‰çš„<code>URL</code>å‚æ•°éƒ½æ˜¯å‘é€<code>json</code>æ•°æ®ï¼Œé‚£ä¹ˆæ­¤æ—¶ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªå«åš<code>JSONResponse</code>çš„ç±»æ¥ä»£æ›¿<code>Response</code>ç±»</p>
<pre><code class="language-python">from flask import Flask, Response, jsonify

# å°†è§†å›¾å‡½æ•°ä¸­è¿”å›çš„å­—å…¸ï¼Œè½¬æ¢æˆjsonå¯¹è±¡ï¼Œç„¶åè¿”å›
class JSONResponse(Response):
    @classmethod
    def force_type(cls, response, environ=None):
        if isinstance(response, dict):
            response = jsonify(response)
        return super(JSONResponse, cls).force_type(response,environ)

app.response_class = JSONResponse

@app.route('/json/')
def json_response():
    return {'username':'alex'}
</code></pre>
<p><img src="https://i.loli.net/2019/06/12/5d0099fd2a97e99449.png" alt=""></p>
<h1 id="jinja2æ¨¡æ¿">Jinja2æ¨¡æ¿</h1>
<h2 id="1æ¨¡æ¿åŸºç¡€">1.æ¨¡æ¿åŸºç¡€</h2>
<p>åœ¨æ¸²æŸ“æ¨¡æ¿çš„æ—¶å€™ï¼Œé»˜è®¤ä¼šä»é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„<code>templates</code>ç›®å½•ä¸‹æŸ¥æ‰¾æ¨¡æ¿</p>
<p>å¦‚æœä¸æƒ³æŠŠæ¨¡æ¿æ–‡ä»¶æ”¾åœ¨<code>templates</code>ç›®å½•ä¸‹ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨<code>Flask</code>åˆå§‹åŒ–çš„æ—¶å€™ç»™<code>template_folder</code>å‚æ•°ä¼ å€¼ï¼Œæ¥æŒ‡å®šæ¨¡æ¿çš„è·¯å¾„</p>
<blockquote>
<p>åœ¨é»˜è®¤æ¨¡æ¿ç›®å½•ä¸‹æŸ¥æ‰¾æ¨¡æ¿</p>
</blockquote>
<pre><code class="language-python">from flask import Flask, render_template

@app.route('/')
def hello():
    return render_template('index.html')  # åœ¨templatesç›®å½•ä¸‹æŸ¥æ‰¾æ¨¡æ¿
</code></pre>
<h2 id="2æ¨¡æ¿å‚æ•°">2.æ¨¡æ¿å‚æ•°</h2>
<p>åœ¨ä½¿ç”¨<code>render_template</code>æ¸²æŸ“æ¨¡æ¿çš„æ—¶å€™ï¼Œå¯ä»¥ä¼ é€’å…³é”®å­—å‚æ•°ï¼Œä»¥åç›´æ¥åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨å°±å¯ä»¥äº†</p>
<p>å¦‚æœå‚æ•°è¿‡å¤šï¼Œé‚£ä¹ˆå¯ä»¥å°†æ‰€æœ‰çš„å‚æ•°æ”¾åˆ°ä¸€ä¸ªå­—å…¸ä¸­ï¼Œç„¶ååœ¨ä¼ è¿™ä¸ªå­—å…¸å‚æ•°çš„æ—¶å€™ï¼Œä½¿ç”¨ä¸¤ä¸ªæ˜Ÿå·ï¼Œå°†å­—å…¸ä¸­çš„æ•°æ®ç»„æˆå…³é”®å­—å‚æ•°ä¼ é€’</p>
<blockquote>
<p>ä¸¾ä¾‹</p>
</blockquote>
<p>è§†å›¾å‡½æ•°ä¸­æ¸²æŸ“æ¨¡æ¿ä¼ é€’å‚æ•°ï¼š</p>
<pre><code class="language-python">@app.route('/')
def hello():
    context = {
        'username':'alex',
        'tel':17688165555
    }
    return render_template('index.html',**context)
</code></pre>
<p><code>HTML</code>ä¸­è°ƒç”¨<code>è§†å›¾å‡½æ•°</code>ä¸­çš„å‚æ•°</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;alex&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;è¿™æ˜¯æ¨¡æ¿æ¸²æŸ“çš„æ•°æ®&lt;/h1&gt;
    &lt;p&gt;{{username}}&lt;/p&gt;  &lt;!-- è°ƒç”¨è§†å›¾å‡½æ•°ä¸­çš„å‚æ•° --&gt;
    &lt;p&gt;{{tel}}&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h2 id="3æ¨¡æ¿ä¸­çš„url_for">3.æ¨¡æ¿ä¸­çš„url_for</h2>
<p>æ¨¡æ¿ä¸­çš„<code>url_for</code>ä¸åå°è§†å›¾å‡½æ•°ä¸­çš„ä½¿ç”¨åŸºæœ¬æ˜¯ä¸€è‡´çš„</p>
<p>ä¹Ÿæ˜¯ä¼ é€’è§†å›¾å‡½æ•°çš„åå­—ï¼Œä¹Ÿå¯ä»¥ä¼ é€’å‚æ•°</p>
<blockquote>
<p>æ³¨æ„ï¼šåœ¨æ¨¡æ¿ä¸­ä½¿ç”¨url_foréœ€è¦åœ¨å·¦å³ä¸¤è¾¹åŠ ä¸Šä¸€å¯¹èŠ±æ‹¬å·ï¼Œ{{ url_for() }}</p>
</blockquote>
<p>ä¸¾ä¾‹ï¼š</p>
<p>åœ¨é¦–é¡µæ¨¡æ¿ä¸­æ·»åŠ ä¸€ä¸ª<code>ç™»å½•</code>é“¾æ¥</p>
<blockquote>
<p>åœ¨è¿™ä¸ªé¦–é¡µæ¨¡æ¿ä¸­ä½¿ç”¨<code>url_for</code>æ¥ä¸loginè§†å›¾å‡½æ•°å¯¹åº”</p>
<p>è¿™ä¸ªçš„å¥½å¤„å°±æ˜¯ï¼Œä¸€æ—¦è§†å›¾å‡½æ•°çš„urlå˜åŒ–ï¼Œæ¨¡æ¿ä¸­ä½¿ç”¨urlçš„åœ°æ–¹ä¼šç›¸åº”å˜åŒ–</p>
</blockquote>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;é¦–é¡µ&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;p&gt; &lt;a href=&quot;{{ url_for('login')}}&quot;&gt;ç™»å½•&lt;/a&gt; &lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>ç„¶åæ–°å»ºä¸€ä¸ª<code>login</code>æ¨¡æ¿</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;alex&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;è¿™æ˜¯ç™»å½•é¡µé¢&lt;/h1&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>æ–°å»ºä¸€ä¸ª<code>login</code>è§†å›¾å‡½æ•°</p>
<pre><code class="language-python">from flask import Flask, render_template, url_for

app = Flask(__name__)


@app.route('/')
def hello():
    context = {
        'username':'alex',
        'tel':17688165555
    }
    return render_template('index.html',**context)

@app.route('/login/')
def login():
    # url_for('login')
    return render_template('login.html')

if __name__ == '__main__':
    app.run(debug=True, port=81)

</code></pre>
 </p>
                      </div>
                  </div>

                  <div class="row">
                      <div class="col-md-12 animate-box">
                          
                              <div class="next-post">
                                  <div class="next">ä¸‹ä¸€ç¯‡</div>
                                  <a href="https://yihangliak.github.io/blog//post/selenium-cong-ru-men-dao-shi-zhan">
                                      <h3 class="post-title">
                                          Selenium ä»å…¥é—¨åˆ°å®æˆ˜
                                      </h3>
                                  </a>
                              </div>
                          
                      </div>
                  </div>

                  <div class="row">
                      <div class="col-md-12 animate-box">
                          
                      </div>
                  </div>
              </div>

          </article>
      </div>
  </div>

    
<footer id="fh5co-footer">
  <p>Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a></p>
</footer>


    
<!-- jQuery -->
<script src="https://yihangliak.github.io/blog//media/scripts/_vendors/jquery.min.js"></script>
<!-- jQuery Easing -->
<script src="https://yihangliak.github.io/blog//media/scripts/_vendors/jquery.easing.1.3.js"></script>
<!-- Bootstrap -->
<script src="https://yihangliak.github.io/blog//media/scripts/_vendors/bootstrap.min.js"></script>
<!-- Waypoints -->
<script src="https://yihangliak.github.io/blog//media/scripts/_vendors/jquery.waypoints.min.js"></script>
<!-- Main JS -->
<script src="https://yihangliak.github.io/blog//media/scripts/_vendors/main.js"></script>
<!-- Md5 Min JS -->
<script src="https://yihangliak.github.io/blog//media/scripts/_vendors/md5.min.js"></script>

<script type="application/javascript">
    hljs.initHighlightingOnLoad();
</script>




  </body>
</html>
